(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5a8fe146"],{"246b":function(t,e,s){"use strict";var i=s("e3fa");s.n(i).a},"4b8a":function(t,e,s){"use strict";var i=s("ddcf");s.n(i).a},"55c0":function(t,e,s){"use strict";var i=s("d7cf");s.n(i).a},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,s){var i=s("1d80"),n="["+s("5899")+"]",a=RegExp("^"+n+n+"*"),r=RegExp(n+n+"*$"),o=function(t){return function(e){var s=String(i(e));return 1&t&&(s=s.replace(a,"")),2&t&&(s=s.replace(r,"")),s}};t.exports={start:o(1),end:o(2),trim:o(3)}},7156:function(t,e,s){var i=s("861d"),n=s("d2bb");t.exports=function(t,e,s){var a,r;return n&&"function"==typeof(a=e.constructor)&&a!==s&&i(r=a.prototype)&&r!==s.prototype&&n(t,r),t}},"7db0":function(t,e,s){"use strict";var i=s("23e7"),n=s("b727").find,a=s("44d2"),r=s("ae40"),o=!0,c=r("find");"find"in[]&&Array(1).find((function(){o=!1})),i({target:"Array",proto:!0,forced:o||!c},{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),a("find")},8448:function(t,e,s){"use strict";(function(t){s("fb6a"),s("b0c0");var i=s("5530"),n=s("74e8"),a=s("2f62"),r=s("a8c2");e.a={components:{Chat:r.a},props:{room:{type:Object,default:function(){return{}}}},data:function(){return{showRoomInfo:!0,someMembers:[]}},computed:Object(i.a)(Object(i.a)({},Object(a.c)("user",["user"])),{},{chatOptions:function(){return{title:this.room.name}}}),watch:{room:function(){this.init()}},created:function(){var t=this;this.init(),n.a((function(e){e.roomID===t.room.id&&t.$refs.chat.receiveChat(e)})),n.d((function(e){t.someMembers.push(e.user),t.$refs.chat.pushMessage(e)})),n.b((function(e){t.$refs.chat.pushMessage(e.content)})),n.c((function(e){setTimeout((function(){t.$refs.chat.unshiftMessage(e.content)}),1e3)}))},beforeDestroy:function(){n.g()},methods:{init:function(){this.room.id>=0&&(this.someMembers=this.room.members.slice(0,4),n.k({room:this.room,user:this.user}))},handleChange:function(t){t[0]&&"join"===t[0].action?this.showRoomInfo=!0:this.showRoomInfo=!1},send:function(e){var s=t.v4(),i={id:s,roomID:this.room.id,userID:this.user.id,head:this.user.head,nickName:this.user.nickName,content:e,type:"user",loading:!0};this.$refs.chat.pushMessage(i),n.i({id:s,roomID:this.room.id,user:this.user,content:e})},getHistoryMessage:function(){n.j({roomID:this.room.id,user:this.user,to:this.$refs.chat.messages[0].date,size:this.$refs.chat.max,direction:-1})}}}}).call(this,s("7ecf"))},a434:function(t,e,s){"use strict";var i=s("23e7"),n=s("23cb"),a=s("a691"),r=s("50c4"),o=s("7b0b"),c=s("65f0"),u=s("8418"),l=s("1dde"),h=s("ae40"),f=l("splice"),d=h("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,v=Math.min;i({target:"Array",proto:!0,forced:!f||!d},{splice:function(t,e){var s,i,l,h,f,d,p=o(this),g=r(p.length),b=n(t,g),y=arguments.length;if(0===y?s=i=0:1===y?(s=0,i=g-b):(s=y-2,i=v(m(a(e),0),g-b)),g+s-i>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(l=c(p,i),h=0;h<i;h++)(f=b+h)in p&&u(l,h,p[f]);if(l.length=i,s<i){for(h=b;h<g-i;h++)d=h+s,(f=h+i)in p?p[d]=p[f]:delete p[d];for(h=g;h>g-i+s;h--)delete p[h-1]}else if(s>i)for(h=g-i;h>b;h--)d=h+s-1,(f=h+i-1)in p?p[d]=p[f]:delete p[d];for(h=0;h<s;h++)p[h+b]=arguments[h+2];return p.length=g-i+s,l}})},a8c2:function(t,e,s){"use strict";s("99af"),s("c740"),s("fb6a"),s("a434");var i=s("2909"),n=s("5530"),a=s("f644"),r=s("2f62");function o(t){return t.scrollTop===t.scrollHeight-t.clientHeight}var c={components:{Editor:s("ceb0").a},filters:{cutText:function(t,e){return Object(a.b)(t,e)}},props:{chat:{type:Object,default:function(){return{}}}},data:function(){return{content:"",messages:[],showBtnNewMessage:!1,action2Text:{join:"加入了房间",leave:"离开了房间"}}},computed:Object(n.a)({},Object(r.c)("user",["user"])),watch:{messages:function(t){this.$emit("change",t)}},created:function(){this.max=5},methods:{send:function(){""!==this.content&&(this.$emit("send",this.content),this.content="")},pushMessage:function(t){if(Array.isArray(t)?this.messages=this.messages.concat(t):this.messages.push(t),this.messages.length>this.max&&o(this.$refs.body)){var e=this.messages.length-this.max;this.messages=this.messages.slice(e)}o(this.$refs.body)?this.toBottom():this.showBtnNewMessage=!0},unshiftMessage:function(t){var e,s=this;(e=this.messages).unshift.apply(e,Object(i.a)(t));var n=this.$refs.body.scrollHeight;this.$nextTick((function(){!function(t,e){var s=t.scrollHeight,i=t.scrollTop;t.scrollTop=s-e+i}(s.$refs.body,n),s.lodaingIns.close()}))},receiveChat:function(t){if(t.userID===this.user.id){var e=this.messages.findIndex((function(e){return e.id===t.id}));e>-1&&this.messages.splice(e,1,t)}else this.pushMessage(t)},toBottom:function(){var t=this;this.$nextTick((function(){t.$refs.body.scrollTop=1e4,t.showBtnNewMessage=!1}))},handleScroll:function(){if(0===this.$refs.body.scrollTop)return this.lodaingIns=this.$loading({target:this.$refs.history,fullscreen:!1,text:"获取更多消息中",customClass:"el-loading-small"}),void this.$emit("get-history-message");this.showBtnNewMessage&&o(this.$refs.body)&&(this.showBtnNewMessage=!1)}}},u=(s("4b8a"),s("2877")),l=Object(u.a)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chat-box"},[s("div",{staticClass:"chat-box-inline"},[s("div",{staticClass:"chat-title"},[t._v(" "+t._s(t.chat.title)+" ")]),s("div",{staticStyle:{position:"relative"}},[s("div",{ref:"body",staticClass:"chat-box-body",on:{scroll:t.handleScroll}},[s("div",{ref:"messageList",staticClass:"chat-box-body-inline"},[s("div",{ref:"history",staticClass:"history"},[t._v(" 历史消息 ")]),t._t("notice"),s("div",{staticClass:"chat-contents"},t._l(t.messages,(function(e){return s("div",{key:e.id,ref:"messages",refInFor:!0},["user"===e.type&&e.userID!==t.user.id?s("div",{staticClass:"chat-item"},[s("div",{staticClass:"item-head-left"},[s("el-avatar",{attrs:{src:e.head,size:46}})],1),s("div",{staticClass:"item-body-left"},[s("div",{staticClass:"item-username"},[t._v(" "+t._s(e.nickName)+" ")]),s("div",{staticClass:"item-content"},[s("pre",[t._v(t._s(e.content))])])])]):"user"===e.type&&e.userID===t.user.id?s("div",{staticClass:"chat-item chat-item-right"},[s("div",{staticClass:"item-body item-body-right"},[s("div",{staticClass:"item-username"},[t._v(" "+t._s(e.nickName)+" ")]),s("div",{staticClass:"item-content-container-right"},[e.loading?s("i",{staticClass:"el-icon-loading"}):t._e(),s("div",{staticClass:"item-content item-content-right"},[s("pre",[t._v(t._s(e.content))])])])]),s("div",{staticClass:"item-head-right"},[s("el-avatar",{attrs:{src:e.head,size:46}})],1)]):"system"===e.type?s("div",{staticClass:"chat-item-system text-gray"},[t._v(" "+t._s(t._f("cutText")(e.user.nickName,10))+" "+t._s(t.action2Text[e.action])+" ")]):t._e()])})),0)],2)]),s("a",{directives:[{name:"show",rawName:"v-show",value:t.showBtnNewMessage,expression:"showBtnNewMessage"}],staticClass:"new-message",on:{click:t.toBottom}},[t._v(" 新消息 ")])]),s("div",{staticClass:"editor-container"},[s("Editor",{staticClass:"editor",attrs:{rows:4},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:void e.preventDefault()},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:t.send(e)}},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)])])}),[],!1,null,null,null);e.a=l.exports},a9e3:function(t,e,s){"use strict";var i=s("83ab"),n=s("da84"),a=s("94ca"),r=s("6eeb"),o=s("5135"),c=s("c6b6"),u=s("7156"),l=s("c04e"),h=s("d039"),f=s("7c73"),d=s("241c").f,m=s("06cf").f,v=s("9bf2").f,p=s("58a8").trim,g=n.Number,b=g.prototype,y="Number"==c(f(b)),_=function(t){var e,s,i,n,a,r,o,c,u=l(t,!1);if("string"==typeof u&&u.length>2)if(43===(e=(u=p(u)).charCodeAt(0))||45===e){if(88===(s=u.charCodeAt(2))||120===s)return NaN}else if(48===e){switch(u.charCodeAt(1)){case 66:case 98:i=2,n=49;break;case 79:case 111:i=8,n=55;break;default:return+u}for(r=(a=u.slice(2)).length,o=0;o<r;o++)if((c=a.charCodeAt(o))<48||c>n)return NaN;return parseInt(a,i)}return+u};if(a("Number",!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var C,w=function(t){var e=arguments.length<1?0:t,s=this;return s instanceof w&&(y?h((function(){b.valueOf.call(s)})):"Number"!=c(s))?u(new g(_(e)),s,w):_(e)},N=i?d(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;N.length>x;x++)o(g,C=N[x])&&!o(w,C)&&v(w,C,m(g,C));w.prototype=b,b.constructor=w,r(n,"Number",w)}},bf48:function(t,e,s){"use strict";s.r(e),s("7db0"),s("a9e3"),s("96cf");var i=s("1da1"),n=s("5530"),a=s("7d24"),r=s("2f62"),o=s("8448").a,c=(s("246b"),s("2877")),u={components:{Chat:Object(c.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chat-room"},[s("Chat",{ref:"chat",attrs:{chat:t.chatOptions},on:{send:t.send,"get-history-message":t.getHistoryMessage,change:t.handleChange},scopedSlots:t._u([{key:"notice",fn:function(){return[s("div",[t.showRoomInfo?s("div",{staticClass:"chat-room-statement"},[t._v(" 拒绝不友善的人身攻击，色情暴力、广告推销、违反者请从外面把门带上 "),s("br"),t._v(" 24小时无人说话房间自动解散 每个房间成员72小时不说话自动退出 ")]):t._e(),t.showRoomInfo?s("div",{staticClass:"chat-room-notice-container"},[s("div",{staticClass:"chat-room-notice"},[s("div",[t._v("房间简介")]),s("div",{staticClass:"notice-conentet"},[s("pre",[t._v(t._s(t.room.notice))])])])]):t._e()])]},proxy:!0}])}),s("div",{staticClass:"room-data"},[s("div",{staticClass:"title"},[t._v(" 房间资料 ")]),s("div",{staticClass:"name"},[s("div",{staticClass:"panel-title"},[t._v(" 房间名称 ")]),s("div",[t._v(" "+t._s(t.room.name)+" ")])]),s("div",{staticClass:"brief"},[s("div",{staticClass:"panel-title"},[t._v(" 房间简介 ")]),s("div",[s("pre",[t._v(t._s(t.room.notice))])])]),s("div",{staticClass:"members"},[s("div",{staticClass:"members-head panel-title"},[s("span",[t._v(" 房间成员 ")]),s("span",[t._v(" "+t._s("查看"+t.room.num+"/"+t.room.total+"名房间成员")+" "),s("i",{staticClass:"el-icon-arrow-right"})])]),s("div",{staticClass:"members-list"},t._l(t.someMembers,(function(e){return s("div",{key:e.id,staticClass:"members-item"},[s("el-avatar",{attrs:{src:e.head,size:46}}),s("div",{staticClass:"members-item-nickname"},[t._v(" "+t._s(e.nickName.length>3?e.nickName.slice(0,3)+"...":e.nickName)+" ")])],1)})),0)])])],1)}),[],!1,null,null,null).exports},props:{id:{type:[String,Number],default:-1}},data:function(){return{room:{}}},computed:Object(n.a)({},Object(r.c)("user",["user"])),created:function(){var t=this;return Object(i.a)(regeneratorRuntime.mark((function e(){var s,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(a.b)();case 2:s=e.sent,i=parseInt(t.id),(n=s.find((function(t){return t.id===i})))&&(t.room=n);case 6:case"end":return e.stop()}}),e)})))()},methods:{}},l=(s("55c0"),Object(c.a)(u,(function(){var t=this.$createElement,e=this._self._c||t;return e("main",{staticClass:"chat-main"},[e("Chat",{attrs:{room:this.room}})],1)}),[],!1,null,null,null));e.default=l.exports},ceb0:function(t,e,s){"use strict";s("a9e3");var i={inheritAttrs:!1,props:{value:{type:[Number,String],default:""}},data:function(){return{input:this.value}},watch:{value:function(t){this.input=t}},methods:{handleInput:function(){this.$emit("input",this.input)},clear:function(){this.input="",this.handleInput()}}},n=(s("cf40"),s("2877")),a=Object(n.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"write-box"},[s("el-input",t._b({attrs:{resize:"none",type:"textarea"},on:{input:t.handleInput},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}},"el-input",t.$attrs,!1))],1)}),[],!1,null,null,null);e.a=a.exports},cf40:function(t,e,s){"use strict";var i=s("e424");s.n(i).a},d7cf:function(t,e,s){},ddcf:function(t,e,s){},e3fa:function(t,e,s){},e424:function(t,e,s){}}]);